<script src="https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js" onload="initializeMermaid()"></script>
<script>
  function initializeMermaid() {
    mermaid.initialize({ 
      startOnLoad: false,
      theme: document.documentElement.getAttribute('data-bs-theme') === 'dark' ? 'dark' : 'default'
    });
    
    // If DOM is already loaded, run immediately
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', renderMermaid);
    } else {
      renderMermaid();
    }
  }
  
  function renderMermaid() {
    mermaid.run({
      querySelector: '.mermaid'
    }).catch(err => console.error('Mermaid render error:', err));
    console.log("Mermaid rendered");
  }

  console.log("INIT SCRIPT")
</script>
